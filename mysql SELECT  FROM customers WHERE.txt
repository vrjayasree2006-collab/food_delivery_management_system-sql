mysql> SELECT * FROM customers WHERE city = 'chennai';
+-------------+-------+-------+---------+
| customer_id | name  | phone | city    |
+-------------+-------+-------+---------+
|           1 | arjun |  9876 | chennai |
+-------------+-------+-------+---------+
1 row in set (0.01 sec)

mysql> DROP TABLE menu_items;
Query OK, 0 rows affected (0.04 sec)

mysql> CREATE TABLE menu_items(item_id INT, restaurant_id INT,item_name VARCHAR(35), category VARCHAR(30), price INT);
Query OK, 0 rows affected (0.04 sec)

mysql> INSERT INTO menu_items VALUES(201,101,'chicken biryani','biryani',180), (202,101,'paneer butter masala','curry',150), (203,102,'andhra chicken curry','curry',200), (204,102,'veg meals','meals',120), (205,103,'butter naan','bread',40), (206,104,'veg sandwich','snacks',90);
Query OK, 6 rows affected (0.01 sec)
Records: 6  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM menu_items WHERE price > 150;
+---------+---------------+----------------------+----------+-------+
| item_id | restaurant_id | item_name            | category | price |
+---------+---------------+----------------------+----------+-------+
|     201 |           101 | chicken biryani      | biryani  |   180 |
|     203 |           102 | andhra chicken curry | curry    |   200 |
+---------+---------------+----------------------+----------+-------+
2 rows in set (0.01 sec)

mysql> SELECT * FROM orders WHERE order_date = '2024-09-11';
+----------+-------------+---------------+------------+
| order_id | customer_id | restaurant_id | order_date |
+----------+-------------+---------------+------------+
|      502 |           2 |           104 | 2024-09-11 |
+----------+-------------+---------------+------------+
1 row in set (0.01 sec)

mysql> SELECT SUM(price) AS total_revenue, restaurant_id FROM menu_items GROUP BY restaurant_id;
+---------------+---------------+
| total_revenue | restaurant_id |
+---------------+---------------+
|           330 |           101 |
|           320 |           102 |
|            40 |           103 |
|            90 |           104 |
+---------------+---------------+
4 rows in set (0.04 sec)

mysql> SELECT COUNT(o.order_id), c.city FROM orders o JOIN customers c ON o.customer_id = c.customer_id GROUP BY c.city;
+-------------------+-----------+
| COUNT(o.order_id) | city      |
+-------------------+-----------+
|                 2 | chennai   |
|                 1 | bangalore |
|                 1 | hyderabad |
+-------------------+-----------+
3 rows in set (0.01 sec)

mysql> SELECT COUNT(quantity) AS total_quantity, item_id FROM order_items GROUP BY item_id;
+----------------+---------+
| total_quantity | item_id |
+----------------+---------+
|              1 |     201 |
|              1 |     202 |
|              1 |     206 |
|              2 |     204 |
+----------------+---------+
4 rows in set (0.00 sec)

mysql> SELECT SUM(quantity) AS total_quantity, item_id FROM order_items GROUP BY item_id;
+----------------+---------+
| total_quantity | item_id |
+----------------+---------+
|              2 |     201 |
|              1 |     202 |
|              3 |     206 |
|              7 |     204 |
+----------------+---------+
4 rows in set (0.00 sec)

mysql> SELECT AVG(price), category FROM menu_items GROUP BY category;
+------------+----------+
| AVG(price) | category |
+------------+----------+
|   180.0000 | biryani  |
|   175.0000 | curry    |
|   120.0000 | meals    |
|    40.0000 | bread    |
|    90.0000 | snacks   |
+------------+----------+
5 rows in set (0.01 sec)

mysql> SELECT c.name, r.restaurant_name, o.order_date FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN restaurants r ON o.restaurant_id = r.restaurant_id;
+-------+----------------------+------------+
| name  | restaurant_name      | order_date |
+-------+----------------------+------------+
| arjun | spice garden         | 2024-09-12 |
| arjun | andhra biryani house | 2024-09-12 |
| kiran | punjabi dhaba        | 2024-09-15 |
| priya | veg treat            | 2024-09-11 |
+-------+----------------------+------------+
4 rows in set (0.00 sec)

mysql> SELECT c.name, o.order_id, oi.item_id FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id WHERE c.name = 'arjun';
+-------+----------+---------+
| name  | order_id | item_id |
+-------+----------+---------+
| arjun |      501 |     201 |
| arjun |      501 |     202 |
| arjun |      503 |     204 |
+-------+----------+---------+
3 rows in set (0.00 sec)

mysql> SELECT COUNT(item_id) AS total_items, restaurant_id FROM menu_items GROUP BY restaurant_id;
+-------------+---------------+
| total_items | restaurant_id |
+-------------+---------------+
|           2 |           101 |
|           2 |           102 |
|           1 |           103 |
|           1 |           104 |
+-------------+---------------+
4 rows in set (0.00 sec)

mysql> SELECT r.restaurant_name, o.order_id FROM restaurants r LEFT JOIN orders o ON r.restaurant_id = o.restaurant_id;
+----------------------+----------+
| restaurant_name      | order_id |
+----------------------+----------+
| spice garden         |      503 |
| andhra biryani house |      503 |
| punjabi dhaba        |      504 |
| veg treat            |      502 |
+----------------------+----------+
4 rows in set (0.00 sec)

mysql> SELECT c.name, o.order_id FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id;
+-------+----------+
| name  | order_id |
+-------+----------+
| arjun |      503 |
| arjun |      501 |
| priya |      502 |
| kiran |      504 |
| sneha |     NULL |
+-------+----------+
5 rows in set (0.00 sec)

mysql> SELECT * FROM menu_items WHERE price > (SELECT AVG(price) FROM menu_items);
+---------+---------------+----------------------+----------+-------+
| item_id | restaurant_id | item_name            | category | price |
+---------+---------------+----------------------+----------+-------+
|     201 |           101 | chicken biryani      | biryani  |   180 |
|     202 |           101 | paneer butter masala | curry    |   150 |
|     203 |           102 | andhra chicken curry | curry    |   200 |
+---------+---------------+----------------------+----------+-------+
3 rows in set (0.02 sec)

mysql> SELECT o.customer_id, SUM(M.PRICE) FROM orders o JOIN menu_items m ON o.restaurant_id = m.restaurant_id GROUP BY o.customer_id;
+-------------+--------------+
| customer_id | SUM(M.PRICE) |
+-------------+--------------+
|           1 |          650 |
|           3 |           40 |
|           2 |           90 |
+-------------+--------------+
3 rows in set (0.00 sec)

1
mysql>  SELECT o.customer_id, SUM(M.PRICE) FROM orders o JOIN menu_items m ON o.restaurant_id = m.restaurant_id GROUP BY o.customer_id HAVING SUM(m.price) > 300;
+-------------+--------------+
| customer_id | SUM(M.PRICE) |
+-------------+--------------+
|           1 |          650 |
+-------------+--------------+
1 row in set (0.00 sec)

mysql> SELECT o.order_id, SUM(m.price) AS total_amount FROM orders o JOIN menu_items m ON o.restaurant_id = m.restaurant_id GROUP BY o.order_id;
+----------+--------------+
| order_id | total_amount |
+----------+--------------+
|      501 |          330 |
|      503 |          320 |
|      504 |           40 |
|      502 |           90 |
+----------+--------------+
4 rows in set (0.00 sec)

mysql> SELECT restaurant_id, MAX(price) AS most_expensive FROM menu_items GROUP BY restaurant_id;
+---------------+----------------+
| restaurant_id | most_expensive |
+---------------+----------------+
|           101 |            180 |
|           102 |            200 |
|           103 |             40 |
|           104 |             90 |
+---------------+----------------+
4 rows in set (0.00 sec)

mysql> SELECT restaurant_id, COUNT(category) FROM menu_items GROUP BY restaurant_id HAVING COUNT(category) > 3;
Empty set (0.00 sec)

mysql> SELECT restaurant_id, COUNT(category) FROM menu_items GROUP BY restaurant_id HAVING COUNT(category) > 1;
+---------------+-----------------+
| restaurant_id | COUNT(category) |
+---------------+-----------------+
|           101 |               2 |
|           102 |               2 |
+---------------+-----------------+
2 rows in set (0.00 sec)

mysql> SELECT item_id, MAX(quantity) AS best selling FROM order_items GROUP BY item_id;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'selling FROM order_items GROUP BY item_id' at line 1
mysql> SELECT item_id, MAX(quantity) AS best_selling FROM order_items GROUP BY item_id;
+---------+--------------+
| item_id | best_selling |
+---------+--------------+
|     201 |            2 |
|     202 |            1 |
|     206 |            3 |
|     204 |            5 |
+---------+--------------+
4 rows in set (0.00 sec)

mysql> SELECT c.customer_id, COUNT(o.order_id) AS highest_number FROM customers c JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id;
+-------------+----------------+
| customer_id | highest_number |
+-------------+----------------+
|           1 |              2 |
|           2 |              1 |
|           3 |              1 |
+-------------+----------------+
3 rows in set (0.00 sec)

mysql> SELECT * FROM menu_items ORDER BY price DESC LIMIT 3;
+---------+---------------+----------------------+----------+-------+
| item_id | restaurant_id | item_name            | category | price |
+---------+---------------+----------------------+----------+-------+
|     203 |           102 | andhra chicken curry | curry    |   200 |
|     201 |           101 | chicken biryani      | biryani  |   180 |
|     202 |           101 | paneer butter masala | curry    |   150 |
+---------+---------------+----------------------+----------+-------+
3 rows in set (0.00 sec)

mysql> DELETE FROM order_items WHERE item_id IS NULL;
Query OK, 0 rows affected (0.01 sec)


mysql> UPDATE menu_items SET item_name = 'chicken pulav' WHERE item_name = 'chicken biryani';
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0
mysql> SELECT * FROM menu_items;
+---------+---------------+----------------------+----------+-------+
| item_id | restaurant_id | item_name            | category | price |
+---------+---------------+----------------------+----------+-------+
|     201 |           101 | chicken pulav        | biryani  |   180 |
|     202 |           101 | paneer butter masala | curry    |   150 |
|     203 |           102 | andhra chicken curry | curry    |   200 |
|     204 |           102 | veg meals            | meals    |   120 |
|     205 |           103 | butter naan          | bread    |    40 |
|     206 |           104 | veg sandwich         | snacks   |    90 |
+---------+---------------+----------------------+----------+-------+
6 rows in set (0.00 sec)